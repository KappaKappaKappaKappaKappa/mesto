(()=>{"use strict";class e{constructor(e,t,s){this._cardData=e,this._cardTemplate=t,this._handleOpenImage=s}createCardElement(){return this._cardElement=this._cardTemplate.content.querySelector(".cards__list-card").cloneNode(!0),this._cardImage=this._cardElement.querySelector(".card__image"),this._cardPlace=this._cardElement.querySelector(".card__place"),this._cardDelBtn=this._cardElement.querySelector(".card__trash"),this._cardLikeBtn=this._cardElement.querySelector(".card__like"),this._cardImage.src=this._cardData.link,this._cardImage.alt=this._cardData.title,this._cardPlace.textContent=this._cardData.title,this._setEventListeners(),this._cardElement}_cardDelete(){this._cardElement.remove()}_cardLike(){this._cardLikeBtn.classList.toggle("card__like_active")}_setEventListeners(){this._cardDelBtn.addEventListener("click",this._cardDelete.bind(this)),this._cardLikeBtn.addEventListener("click",this._cardLike.bind(this)),this._cardImage.addEventListener("click",(()=>{this._handleOpenImage(this._cardData)}))}}class t{constructor(e,t){this._settings=e,this._formEl=t,this._inputList=Array.from(this._formEl.querySelectorAll(this._settings.inputSelector)),this._buttonEl=this._formEl.querySelector(this._settings.buttonSelector)}_checkValid(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_showInputError(e,t){const s=this._formEl.querySelector(`.pop-up__form-${e.id}-error`);e.classList.add(this._settings.inputErrorClass),s.textContent=t}_hideInputError(e){const t=this._formEl.querySelector(`.pop-up__form-${e.id}-error`);e.classList.remove(this._settings.inputErrorClass),t.textContent=""}_setEventListeners(){this._toggleButtonSaveState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkValid(e),this._toggleButtonSaveState()}))}))}_disableBtnSave(){this._buttonEl.classList.add(this._settings.inactiveButtonClass),this._buttonEl.setAttribute("disabled","")}_removeDisableBtnSave(){this._buttonEl.classList.remove(this._settings.inactiveButtonClass),this._buttonEl.removeAttribute("disabled")}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_toggleButtonSaveState(){this._hasInvalidInput()?this._disableBtnSave():this._removeDisableBtnSave()}clearInputErrors(){this._inputList.forEach((e=>{this._hideInputError(e)}))}enableValidation(){this._formEl.addEventListener("reset",(()=>{this._disableBtnSave()})),this._setEventListeners()}}const s={formSelector:".pop-up__form",inputSelector:".pop-up__form-input",buttonSelector:".pop-up__form-button-save",inactiveButtonClass:"pop-up__form-button-save_inactive",inputErrorClass:"pop-up__form-input_type_error"},r=document.querySelector(".profile-info__edit-button"),i=document.querySelector(".profile__add-button"),o=".pop-up_show_edit-profile",n=document.querySelector(".card-template"),a=document.querySelector(".pop-up_show_edit-profile").querySelector(".pop-up__form"),p=document.querySelector(".pop-up_show_add-cards").querySelector(".pop-up__form");class l{constructor(e){this._popup=document.querySelector(e),this._popupButtonClose=this._popup.querySelector(".pop-up__button-close")}_handleCloseEscPopup=e=>{"Escape"===e.key&&this.close()};_handleButtonClose=()=>{this.close()};_handleClickOverlay=e=>{e.target===e.currentTarget&&this.close()};setEventListeners(){this._popupButtonClose.addEventListener("click",this._handleButtonClose),this._popup.addEventListener("click",this._handleClickOverlay)}open(){this._popup.classList.add("pop-up_opened"),document.addEventListener("keydown",this._handleCloseEscPopup)}close(){this._popup.classList.remove("pop-up_opened"),document.removeEventListener("keydown",this._handleCloseEscPopup)}}class c extends l{constructor(e,t){super(e),this._submitFunction=t,this._form=this._popup.querySelector(".pop-up__form"),this._inputList=this._form.querySelectorAll(".pop-up__form-input")}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._submitFunction(this._getInputValues()),this.close()}))}close(){super.close(),this._form.reset()}}const d=new class{constructor(e){this._profileName=document.querySelector(e.profileNameSelector),this._profileProfession=document.querySelector(e.profileProfessionSelector)}getUserInfo(){return{username:this._profileName.textContent,profession:this._profileProfession.textContent}}setUserInfo(e){this._profileName.textContent=e.username,this._profileProfession.textContent=e.profession}}({profileNameSelector:".profile-info__name",profileProfessionSelector:".profile-info__profession"}),_=new class extends l{constructor(e){super(e),this._popupImage=this._popup.querySelector(".pop-up__image"),this._popupImageName=this._popup.querySelector(".pop-up__card-name")}open=e=>{this._popupImage.src=e.link,this._popupImage.alt=e.title,this._popupImageName.textContent=e.title,super.open()}}(".pop-up_show_zoom-card");_.setEventListeners();const u=new c(o,(e=>{d.setUserInfo(e)}));u.setEventListeners();const h=new c(".pop-up_show_add-cards",(e=>{f.addItem(f.renderer(e))}));h.setEventListeners();const m=new l(o);m.setEventListeners();const f=new class{constructor({items:e,renderer:t},s){this._container=document.querySelector(s),this._initialCard=e,this.renderer=t}addCardFromArr(){this._initialCard.forEach((e=>{this.addItem(this.renderer(e))}))}addItem(e){this._container.prepend(e)}}({items:[{title:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{title:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{title:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{title:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{title:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{title:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:t=>new e(t,n,_.open).createCardElement()},".cards__list");f.addCardFromArr(),r.addEventListener("click",(()=>{v.clearInputErrors(),u.setInputValues(d.getUserInfo()),m.open()})),i.addEventListener("click",(()=>{h.open(),E.clearInputErrors()}));const v=new t(s,a);v.enableValidation();const E=new t(s,p);E.enableValidation()})();